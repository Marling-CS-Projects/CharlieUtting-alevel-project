# 2.2.12 Cycle 12

## Design

### Objectives

In this cycle I want to make the zombies interact with the player.

*

### Usability Features

### Key Variables

| Variable Name | Use                                                                                                                                                                                                                                                      |
| ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| arcade        | This is the variable that holds the font that I am going to use for the game.                                                                                                                                                                            |
| gameOver      | The variable for the gameOver text.                                                                                                                                                                                                                      |
| boss          | This is the variable for the boss sprite that will spawn at the end of the game. This will be part of the Zombie class and will be in the zombies physics group.                                                                                         |
| health        | The variable that will reduce when the player is in contact with the zombies and the boss.                                                                                                                                                               |
| i             | This is the variable that was used to mark the place in the array ironGoals.                                                                                                                                                                             |
| cooldown      | A boolean which is similar to the delay variable which stops the player from taking too much damage all at once. There will be a variable for each zombie so that if you are in contact with more than one they will take your health at a greater rate. |
| h             | Health variables for the individual zombies and the boss.                                                                                                                                                                                                |
| zomDam        | The variable that will store the amount of damage that the members of the zombies physic group will do.                                                                                                                                                  |

### Pseudocode

<pre><code><strong>define zomDam = 3
</strong>define boss
define gameOver

preload{
    ...
    load bitmapFont(arcade, address of font image in assets folder, adress of the font xml file in the assets folder)
}</code></pre>

```
create{
    ...
    text = addbitmapText(x:390, y:20, font: arcade, `Iron: ${ironCount} out of ${ironGoal}`, size: 15)

    text2 = addbitmapText(x:20, y:20, font: arcade, `Health:$ {health}`, size: 15)
    
    coords = addbitmapText(x:20, y:40, font: arcade, `X: ${player.x} Y: ${player.y}`, size: 15)

    gameOver = addbitmapText(x:320, y:240, font: arcade, `Game Over`, size: 50)

    gameOver visible = false
    ...
}
...
function collectIron(){
    ...
    set text(`Iron: ${ironCount}/ ${ironGoal}`)
    if i == 5{
        boss = new Zombie(32, 1722, zombieImg)
        bossScale(x: 4, y: 4)
        add zombies(boss)
        zombie.h = 10000
        zomDam = 20
        health = 120
    }
    ...
}
...
function takeDamage(player, zombie) {
    ...
    if health <= 0{
        player visible=false
        physics = pause
        gameOver visible=true
        setText text2(`Health: 0`)
    }
}
...
```

### Outcome

```javascript
import font from './assets/arcade.png'
import fontxml from './assets/arcade.xml'
//...
let boss;
let gameOver;
let zomDam = 3
//...
function preload ()
{
    //...
    this.load.bitmapFont('arcade', font, fontxml);
}
//...

function create{
    text = this.add.bitmapText(390, 20,'arcade', `Iron: ${ironCount} out of ${ironGoal}`,15)
    text.setScrollFactor(0);

    coords = this.add.bitmapText(20, 40,'arcade', `X: ${player.x}Y: ${player.y}`,15)
    coords.setScrollFactor(0)

    text2 = this.add.bitmapText(20, 20, 'arcade', `Health: ${health}`,15)
    text2.setScrollFactor(0);

    gameOver = this.add.bitmapText(320, 240, 'arcade', `Game Over`, 50)
    gameOver.setScrollFactor(0)
    gameOver.setOrigin(0.5)
    gameOver.visible=false
    
    for (let i = 0; i < 5; i++) {
        zombie = new Zombie(this, Phaser.Math.Between(1608, 1786), Phaser.Math.Between(0, 1784), 'zombieImg')
        zombies.add(zombie)
    }
    for (let i = 0; i < 11; i++) {
        zombie = new Zombie(this, Phaser.Math.Between(1320, 1560), Phaser.Math.Between(0, 1784), 'zombieImg')
        zombies.add(zombie)
    }
    for (let i = 0; i < 16; i++) {
        zombie = new Zombie(this, Phaser.Math.Between(968, 1272), Phaser.Math.Between(0, 1784), 'zombieImg')
        zombies.add(zombie)
    }
    for (let i = 0; i < 25; i++) {
        zombie = new Zombie(this, Phaser.Math.Between(424, 888), Phaser.Math.Between(0, 1784), 'zombieImg')
        zombies.add(zombie)
    }
    for (let i = 0; i < 30; i++) {
        zombie = new Zombie(this, Phaser.Math.Between(8, 376), Phaser.Math.Between(0, 1784), 'zombieImg')
        zombies.add(zombie)
    }
}
//...

function collectIron(player, iron){
    //...
    if(i == 5){
        boss = new Zombie(this, 32, 1722, 'zombieImg')
        boss.setScale(4,4)
        boss.h = 10000
        zombies.add(boss)
        zomDam = 20
        health = 120
        text2.setText(`Health: ${health}`)
    }
    //...
}
//...
function takeDamage(player, zombie) {
    if (zombie.cooldown == false) {
        health = health - zomDam;
        zombie.cooldown = true;
        this.time.delayedCall(200, function cd(){
            zombie.cooldown = false;
        })
        text2.setText(`Health: ${health}`)
    }
    if (health <= 0){
        player.visible=false
        this.physics.pause()
        gameOver.visible=true
        text2.setText(`Health: 0`)
    }
}

//...
```

### Challenges

The main challenge was importing the bitmap text as I had not used that part of phasers syntax before.

## Testing

### Tests

| Test | Instructions                             | What I expect                                                                                                                                                            | What actually happens                                                           | Pass/Fail |
| ---- | ---------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------- | --------- |
| 1    | Run code                                 | The text should now be displayed in a different font                                                                                                                     | The formatting on the text is now completely not working so the text is default | Fail      |
| 2    | Run code                                 | The text should now be displayed in the new font                                                                                                                         | As expected                                                                     | Pass      |
| 3    | Let the zombies take all of your health. | The health should be displayed as zero. The zombies should stop moving and the player should disappear. The game over message should appear in the middle of the screen. | As expected.                                                                    | Pass      |
| 4    | Collect all of the iron in the level     | The boss should spawn in and the players health should be restored.                                                                                                      | As expected.                                                                    | Pass      |
| 5    | Move around the boss                     | The boss should follow you like the other zombies.                                                                                                                       | As expected                                                                     | Pass      |
| 6    | Let the boss collide with you.           | 20 of the player's health should disappear.                                                                                                                              | As expected.                                                                    | Pass      |

### Evidence

{% embed url="https://youtu.be/nTfJRpNTdDQ" %}
Video of the boss spawning and triggering the game over state as the player's health has reached zero.
{% endembed %}
